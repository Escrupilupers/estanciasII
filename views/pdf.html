<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Exportar Tabla a PDF</title>
<style>
  body{ font-family: Arial, sans-serif; padding: 20px; }
  .tabla-pdf{ width: 100%; border-collapse: collapse; background: #ffffff; }
  .tabla-pdf th, .tabla-pdf td{ border: 1px solid #ddd; padding: 8px; text-align: left; }
  .tabla-pdf th{ font-weight: bold; }
  #btnPDF{ padding: 10px 15px; border: none; background: black; color: white; cursor: pointer; margin-bottom: 20px; }
</style>
</head>
<body>

<h2>Reporte de Usuarios</h2>
<img id="logo" src="https://via.placeholder.com/120x50?text=LOGO" alt="Logo" style="margin-bottom: 15px;">

<button id="btnPDF">Exportar a PDF</button>

<table class="tabla-pdf" id="tablaDatos">
  <thead>
    <tr>
      <th>Nombre</th>
      <th>Rol</th>
      <th>Correo</th>
      <th>Estado</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>Juan Pérez</td><td>Administrador</td><td>juan@example.com</td><td>Activo</td></tr>
    <tr><td>María López</td><td>Editor</td><td>maria@example.com</td><td>Inactivo</td></tr>
    <tr><td>Carlos Reyes</td><td>Usuario</td><td>carlos@example.com</td><td>Activo</td></tr>
    <tr><td>Ana Torres</td><td>Moderador</td><td>ana@example.com</td><td>Activo</td></tr>
  </tbody>
</table>

<!-- LIBRERÍAS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>

<script>
document.getElementById("btnPDF").addEventListener("click", async () => {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF("p", "mm", "a4");

  // Logo
  const logo = document.getElementById("logo");
  let imgData = await getBase64Image(logo);
  doc.addImage(imgData, "PNG", 10, 10, 40, 20);

  // Título
  doc.setFontSize(14);
  doc.text("REPORTE GENERAL DE USUARIOS", 55, 22);

  // Tabla
  doc.autoTable({
    startY: 40,
    html: "#tablaDatos",
    theme: "grid",
    styles: { fontSize: 9, cellPadding: 2 },
    headStyles: { fillColor: false }, // Blanco
    margin: { top: 10 }
  });

  doc.save("reporte.pdf");
});

// Convertir imagen a base64
function getBase64Image(img) {
  return new Promise((resolve) => {
    const canvas = document.createElement("canvas");
    canvas.width = img.width;
    canvas.height = img.height;
    const ctx = canvas.getContext("2d");
    ctx.drawImage(img, 0, 0);
    resolve(canvas.toDataURL("image/png"));
  });
}
</script>

</body>
</html>
